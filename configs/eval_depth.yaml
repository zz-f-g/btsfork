defaults:
    - default
    - data: kitti_raw
    - _self_

name: "eval_depth"
model: "bts"

checkpoint: "out/kitti_360/pretrained"


log_every: 10
batch_size: 1

data:
    image_size: [192, 640]
    data_fc: 1

model_conf:
    arch: "BTSNet"
    use_code: true
    use_scales: true

    code:
        num_freqs: 6
        freq_factor: 1.5
        include_input: true

    encoder:
        type: "monodepth2"
        freeze: false
        pretrained: true
        resnet_layers: 50
        num_ch_dec: [32,32,64,128,256]
        d_out: 64

    mlp_coarse:
        type : "resnet"
        n_blocks : 0
        d_hidden : 64

    mlp_fine:
        type : "empty"
        n_blocks : 1
        d_hidden : 128

    z_near: 3
    z_far: 80
    ray_batch_size: 256
    inv_z: true

    code_mode: z

    n_frames_encoder: 1
    n_frames_render: 1

    dsine_pt:
        NNET_architecture: v02
        NNET_output_dim: 3
        NNET_output_type: 'R'
        NNET_feature_dim: 64
        NNET_hidden_dim: 64

        NNET_encoder_B: 5

        NNET_decoder_NF: 2048
        NNET_decoder_BN: False
        NNET_decoder_down: 8
        NNET_learned_upsampling: true

        NRN_prop_ps: 5
        NRN_num_iter_train: 5
        NRN_num_iter_test: 5
        NRN_ray_relu: true

        data_augmentation_intrins: true
        input_height: 0
        input_width: 0
        data_augmentation_hflip: true
        data_augmentation_appear: 2

        diff_lr: true
        loss_fn: AL
        loss_gamma: 0.8

        num_epochs: 5
        batch_size: 4
        workers: 32
        accumulate_grad_batches: 4

        gpus: 0

        validate_every: 20000
        visualize_every: 10000

        ckpt_path: ./dsine/projects/dsine/checkpoints/exp001_cvpr2024/dsine.pt

renderer:
    n_coarse : 64
    n_fine : 0
    n_fine_depth : 0
    depth_std : 1.00
    sched : []
    white_bkgd : false
    lindisp: true
    hard_alpha_cap: true
